!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).redom={})}(this,(function(e){"use strict";function t(e,t){var i=function(e){for(var t=e.split(/([.#])/),i="",n="",o=1;o<t.length;o+=2)switch(t[o]){case".":i+=" "+t[o+1];break;case"#":n=t[o+1]}return{className:i.trim(),tag:t[0]||"div",id:n}}(e),n=i.tag,o=i.id,r=i.className,l=t?document.createElementNS(t,n):document.createElement(n);return o&&(l.id=o),r&&(t?l.setAttribute("class",r):l.className=r),l}function i(e){for(var i,n=[],o=arguments.length-1;o-- >0;)n[o]=arguments[o+1];var r=typeof e;if("string"===r)i=t(e);else{if("function"!==r)throw new Error("At least one argument required");var l=e;i=new(Function.prototype.bind.apply(l,[null].concat(n)))}return y(g(i),n,!0),i}var n=i,o=i;function r(e,t){var i=g(e),n=g(t);return t===n&&n.__redom_view&&(t=n.__redom_view),n.parentNode&&(l(t,n,i),i.removeChild(n)),t}function l(e,t,i){var n=t.__redom_lifecycle;if(s(n))t.__redom_lifecycle={};else{var o=i;for(t.__redom_mounted&&d(t,"onunmount");o;){var r=o.__redom_lifecycle||{};for(var l in n)r[l]&&(r[l]-=n[l]);s(r)&&(o.__redom_lifecycle=null),o=o.parentNode}}}function s(e){if(null==e)return!0;for(var t in e)if(e[t])return!1;return!0}i.extend=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return i.bind.apply(i,[this].concat(e))};var u=["onmount","onremount","onunmount"],a="undefined"!=typeof window&&"ShadowRoot"in window;function f(e,t,i,n){var o=g(e),r=g(t);t===r&&r.__redom_view&&(t=r.__redom_view),t!==r&&(r.__redom_view=t);var s=r.__redom_mounted,f=r.parentNode;if(s&&f!==o&&l(0,r,f),null!=i)if(n){var h=g(i);h.__redom_mounted&&d(h,"onunmount"),o.replaceChild(r,h)}else o.insertBefore(r,g(i));else o.appendChild(r);return function(e,t,i,n){for(var o=t.__redom_lifecycle||(t.__redom_lifecycle={}),r=i===n,l=!1,s=0,f=u;s<f.length;s+=1){var h=f[s];r||e!==t&&h in e&&(o[h]=(o[h]||0)+1),o[h]&&(l=!0)}if(!l)return void(t.__redom_lifecycle={});var v=i,c=!1;(r||v&&v.__redom_mounted)&&(d(t,r?"onremount":"onmount"),c=!0);for(;v;){var _=v.parentNode,p=v.__redom_lifecycle||(v.__redom_lifecycle={});for(var w in o)p[w]=(p[w]||0)+o[w];if(c)break;(v.nodeType===Node.DOCUMENT_NODE||a&&v instanceof ShadowRoot||_&&_.__redom_mounted)&&(d(v,r?"onremount":"onmount"),c=!0),v=_}}(t,r,o,f),t}function d(e,t){"onmount"===t||"onremount"===t?e.__redom_mounted=!0:"onunmount"===t&&(e.__redom_mounted=!1);var i=e.__redom_lifecycle;if(i){var n=e.__redom_view,o=0;for(var r in n&&n[t]&&n[t](),i)r&&o++;if(o)for(var l=e.firstChild;l;){var s=l.nextSibling;d(l,t),l=s}}}function h(e,t,i){var n=g(e);if("object"==typeof t)for(var o in t)v(n,o,t[o]);else v(n,t,i)}function v(e,t,i){e.style[t]=null==i?"":i}var c="http://www.w3.org/1999/xlink";function _(e,t,i,n){var o=g(e);if("object"==typeof t)for(var r in t)_(o,r,t[r],n);else{var l=o instanceof SVGElement,s="function"==typeof i;if("style"===t&&"object"==typeof i)h(o,i);else if(l&&s)o[t]=i;else if("dataset"===t)w(o,i);else if(l||!(t in o)&&!s||"list"===t){if(l&&"xlink"===t)return void p(o,i);n&&"class"===t&&(i=o.className+" "+i),null==i?o.removeAttribute(t):o.setAttribute(t,i)}else o[t]=i}}function p(e,t,i){if("object"==typeof t)for(var n in t)p(e,n,t[n]);else null!=i?e.setAttributeNS(c,t,i):e.removeAttributeNS(c,t,i)}function w(e,t,i){if("object"==typeof t)for(var n in t)w(e,n,t[n]);else null!=i?e.dataset[t]=i:delete e.dataset[t]}function m(e){return document.createTextNode(null!=e?e:"")}function y(e,t,i){for(var n=0,o=t;n<o.length;n+=1){var r=o[n];if(0===r||r){var l=typeof r;"function"===l?r(e):"string"===l||"number"===l?e.appendChild(m(r)):N(g(r))?f(e,r):r.length?y(e,r,i):"object"===l&&_(e,r,null,i)}}}function b(e){return"string"==typeof e?i(e):g(e)}function g(e){return e.nodeType&&e||!e.el&&e||g(e.el)}function N(e){return e&&e.nodeType}function x(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];for(var n=k(e,t,g(e).firstChild);n;){var o=n.nextSibling;r(e,n),n=o}}function k(e,t,i){for(var n=i,o=Array(t.length),r=0;r<t.length;r++)o[r]=t[r]&&g(t[r]);for(var l=0;l<t.length;l++){var s=t[l];if(s){var u=o[l];if(u!==n)if(N(u)){var a=n&&n.nextSibling,d=null!=s.__redom_index&&a===o[l+1];f(e,s,n,d),d&&(n=a)}else null!=s.length&&(n=k(e,s,n));else n=n.nextSibling}}return n}var S=function(e,t,i){this.View=e,this.initData=i,this.oldLookup={},this.lookup={},this.oldViews=[],this.views=[],null!=t&&(this.key="function"==typeof t?t:function(e){return function(t){return t[e]}}(t))};function E(e,t,i,n){return new A(e,t,i,n)}S.prototype.update=function(e,t){for(var i=this,n=i.View,o=i.key,r=i.initData,l=null!=o,s=this.lookup,u={},a=Array(e.length),f=this.views,d=0;d<e.length;d++){var h=e[d],v=void 0;if(l){var c=o(h);v=s[c]||new n(r,h,d,e),u[c]=v,v.__redom_id=c}else v=f[d]||new n(r,h,d,e);v.update&&v.update(h,d,e,t),g(v.el).__redom_view=v,a[d]=v}this.oldViews=f,this.views=a,this.oldLookup=s,this.lookup=u};var A=function(e,t,i,n){this.View=t,this.initData=n,this.views=[],this.pool=new S(t,i,n),this.el=b(e),this.keySet=null!=i};A.prototype.update=function(e,t){void 0===e&&(e=[]);var i=this.keySet,n=this.views;this.pool.update(e,t);var o=this.pool,l=o.views,s=o.lookup;if(i)for(var u=0;u<n.length;u++){var a=n[u];null==s[a.__redom_id]&&(a.__redom_index=null,r(this,a))}for(var f=0;f<l.length;f++){l[f].__redom_index=f}x(this,l),i&&(this.lookup=s),this.views=l},A.extend=function(e,t,i,n){return A.bind(A,e,t,i,n)},E.extend=A.extend;var D=function(e,t){this.el=m(""),this.visible=!1,this.view=null,this._placeholder=this.el,e instanceof Node?this._el=e:e.el instanceof Node?(this._el=e,this.view=e):this._View=e,this._initData=t};D.prototype.update=function(e,t){var i=this._placeholder,n=this.el.parentNode;if(e){if(!this.visible)if(this._el)f(n,this._el,i),r(n,i),this.el=g(this._el),this.visible=e;else{var o=new(0,this._View)(this._initData);this.el=g(o),this.view=o,f(n,o,i),r(n,i)}this.view&&this.view.update&&this.view.update(t)}else if(this.visible){if(this._el)return f(n,i,this._el),r(n,this._el),this.el=i,void(this.visible=e);f(n,i,this.view),r(n,this.view),this.el=i,this.view=null}this.visible=e};var j=function(e,t,i){this.el=b(e),this.views=t,this.Views=t,this.initData=i};j.prototype.update=function(e,t){if(e!==this.route){var i=this.views[e];this.route=e,i&&(i instanceof Node||i.el instanceof Node)?this.view=i:this.view=i&&new i(this.initData,t),x(this.el,[this.view])}this.view&&this.view.update&&this.view.update(t,e)};var C="http://www.w3.org/2000/svg";function V(e){for(var i,n=[],o=arguments.length-1;o-- >0;)n[o]=arguments[o+1];var r=typeof e;if("string"===r)i=t(e,C);else{if("function"!==r)throw new Error("At least one argument required");var l=e;i=new(Function.prototype.bind.apply(l,[null].concat(n)))}return y(g(i),n,!0),i}var T=V;V.extend=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return V.bind.apply(V,[this].concat(e))},V.ns=C,e.List=A,e.ListPool=S,e.Place=D,e.Router=j,e.dispatch=function(e,t,i){void 0===i&&(i="redom");var n=g(e),o=new CustomEvent(i,{bubbles:!0,detail:t});n.dispatchEvent(o)},e.el=n,e.h=o,e.html=i,e.list=E,e.listPool=function(e,t,i){return new S(e,t,i)},e.mount=f,e.place=function(e,t){return new D(e,t)},e.router=function(e,t,i){return new j(e,t,i)},e.s=T,e.setAttr=function(e,t,i){_(e,t,i)},e.setChildren=x,e.setData=w,e.setStyle=h,e.setXlink=p,e.svg=V,e.text=m,e.unmount=r,e.viewFactory=function(e,t){if(!e||"object"!=typeof e)throw new Error("views must be an object");if(!t||"string"!=typeof t)throw new Error("key must be a string");return function(i,n,o,r){var l=n[t],s=e[l];if(s)return new s(i,n,o,r);throw new Error("view "+l+" not found")}}}));