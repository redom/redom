(function(e,v){"object"===typeof exports&&"undefined"!==typeof module?v(exports):"function"===typeof define&&define.amd?define(["exports"],v):v(e.redom={})})(this,function(e){function v(a,c,b){for(var d=0;d<c.length;d++){var f=c[d];if(f){var r=g(f);r===b?b=b.nextSibling:r&&r.nodeType?k(a,f,b):null!=f.length&&(b=v(a,f,b))}}return b}var y=function(a,c){for(var b,d=null,f=b=null,r=0,e=0,h=0;h<=a.length;h++){var g=a.charCodeAt(h),q=35===g,n=46===g;g=!g;if(q||n||g)0===r?d=0===h?"div":a.substring(e,h):
1===r?b=a.substring(e,h):f=f?f+(" "+a.substring(e,h)):a.substring(e,h),q?r=1:n&&(r=2),e=h+1}a=d;a=c?document.createElementNS(c,a):document.createElement(a);b&&(a.id=b);f&&(c?a.setAttribute("class",f):a.className=f);return a},l=function(a,c){a=g(a);var b=g(c);c===b&&b.__redom_view&&(c=b.__redom_view);b.parentNode&&(L(c,b,a),a.removeChild(b));return c},L=function(a,c,b){if(a=c.__redom_lifecycle)for(c.__redom_mounted&&z(c,"onunmount");b;){c=b.__redom_lifecycle||(b.__redom_lifecycle={});var d=!1,f;for(f in a)c[f]&&
(c[f]-=a[f]),c[f]&&(d=!0);d||(b.__redom_lifecycle=null);b=b.parentNode}else c.__redom_mounted=!1},M=["onmount","onunmount"],P="ShadowRoot"in window,k=function(a,c,b){var d=g(a);a=g(c);c===a&&a.__redom_view&&(c=a.__redom_view);c!==a&&(a.__redom_view=c);var f=a.parentNode;a.__redom_mounted&&f!==d&&L(c,a,f);null!=b?d.insertBefore(a,g(b)):d.appendChild(a);var e=c;b=a.__redom_lifecycle||(a.__redom_lifecycle={});f=d===f;for(var m=!1,h=0;h<M.length;h++){var k=M[h];!f&&e!==a&&k in e&&(b[k]=(b[k]||0)+1);b[k]&&
(m=!0)}if(m){e=!1;if(f||!e&&d&&d.__redom_mounted)z(a,f?"onremount":"onmount"),e=!0;if(!f)for(;d;){a=d.parentNode;m=d.__redom_lifecycle||(d.__redom_lifecycle={});for(var q in b)m[q]=(m[q]||0)+b[q];!e&&(d===document||P&&d instanceof window.ShadowRoot||a&&a.__redom_mounted)&&(z(d,f?"onremount":"onmount"),e=!0);d=a}}else a.__redom_mounted=!0;return c},z=function(a,c){"onmount"===c?a.__redom_mounted=!0:"onunmount"===c&&(a.__redom_mounted=!1);var b=a.__redom_lifecycle;if(b){var d=a.__redom_view,f=0;d&&
d[c]&&d[c]();for(var e in b)e&&f++;if(f)for(a=a.firstChild;a;)b=a.nextSibling,z(a,c),a=b}},D=function(a,c,b){a=g(a);if(void 0!==b)a.style[c]=b;else if(w(c))a.setAttribute("style",c);else for(var d in c)D(a,d,c[d])},F=function(a,c,b){a=g(a);var d=a instanceof SVGElement;if(void 0!==b)if("style"===c)D(a,b);else if(d&&E(b))a[c]=b;else if("dataset"===c)for(var f in b)a.dataset[f]=b[f];else if(!d&&(c in a||E(b)))a[c]=b;else if(d&&"xlink"===c)for(var e in b)a.setAttributeNS("http://www.w3.org/1999/xlink",
e,b[e]);else a.setAttribute(c,b);else for(var m in c)F(a,m,c[m])},G=function(a){return document.createTextNode(null!=a?a:"")},H=function(a,c){for(var b=0;b<c.length;b++){var d=c[b];if(0===d||d)if("function"===typeof d)d(a);else if(w(d)||"number"===typeof d)a.appendChild(G(d));else{var f=g(d);f&&f.nodeType?k(a,d):d.length?H(a,d):"object"===typeof d&&F(a,d)}}},N=function(a){return w(a)?p(a):g(a)},g=function(a){return a.nodeType&&a||!a.el&&a||g(a.el)},w=function(a){return"string"===typeof a},E=function(a){return"function"===
typeof a},A={},p=function(a){for(var c=[],b=arguments.length-1;0<b--;)c[b]=arguments[b+1];if(w(a))b=(A[a]||(A[a]=y(a))).cloneNode(!1);else if(a&&a.nodeType)b=a.cloneNode(!1);else throw Error("At least one argument required");H(b,c);return b};p.extend=function(a){for(var c=[],b=arguments.length-1;0<b--;)c[b]=arguments[b+1];b=A[a]||(A[a]=y(a));return p.bind.apply(p,[this,b].concat(c))};var I=function(a){for(var c=[],b=arguments.length-1;0<b--;)c[b]=arguments[b+1];b=g(a);for(c=v(a,c,b.firstChild);c;)b=
c.nextSibling,l(a,c),c=b},Q=function(a){return function(c){return c[a]}},B=function(a,c,b){this.View=a;this.initData=b;this.oldLookup={};this.lookup={};this.oldViews=[];this.views=[];null!=c&&(this.lookup={},this.key=E(c)?c:Q(c))};B.prototype.update=function(a,c){for(var b=this.View,d=this.key,f=this.initData,e=null!=d,m=this.lookup,h={},k=Array(a.length),q=this.views,n=0;n<a.length;n++){var l=a[n];if(e){var p=d(l);var t=m[p]||new b(f,l,n,a);h[p]=t;t.__redom_id=p}else t=q[n]||new b(f,l,n,a);t.update&&
t.update(l,n,a,c);g(t.el).__redom_view=t;k[n]=t}this.oldViews=q;this.views=k;this.oldLookup=m;this.lookup=h};var O=function(a,c,b,d){return new u(a,c,b,d)},u=function(a,c,b,d){this.__redom_list=!0;this.View=c;this.initData=d;this.views=[];this.pool=new B(c,b,d);this.el=N(a);this.keySet=null!=b};u.prototype.update=function(a,c){void 0===a&&(a=[]);var b=this.keySet,d=this.views,f=b&&this.lookup;this.pool.update(a,c);c=this.pool;a=c.views;c=c.lookup;if(b)for(var e=0;e<d.length;e++){var g=d[e].__redom_id;
g in c||l(this,f[g])}I(this,a);b&&(this.lookup=c);this.views=a};u.extend=function(a,c,b,d){return u.bind(u,a,c,b,d)};O.extend=u.extend;var J=function(a,c){this.el=G("");this.visible=!1;this.view=null;this._placeholder=this.el;a instanceof Node?this._el=a:this._View=a;this._initData=c};J.prototype.update=function(a,c){var b=this._placeholder,d=this.el.parentNode;if(a){if(!this.visible){if(this._el){k(d,this._el,b);l(d,b);this.el=this._el;this.visible=a;return}var e=new this._View(this._initData);this.el=
g(e);this.view=e;k(d,e,b);l(d,b)}this.view&&this.view.update&&this.view.update(c)}else if(this.visible){if(this._el){k(d,b,this._el);l(d,this._el);this.el=b;this.visible=a;return}k(d,b,this.view);l(d,this.view);this.el=b;this.view=null}this.visible=a};var K=function(a,c,b){this.el=N(a);this.Views=c;this.initData=b};K.prototype.update=function(a,c){if(a!==this.route){var b=this.Views[a];this.route=a;this.view=b&&new b(this.initData,c);I(this.el,[this.view])}this.view&&this.view.update&&this.view.update(c,
a)};var C={},x=function(a){for(var c=[],b=arguments.length-1;0<b--;)c[b]=arguments[b+1];if(w(a))b=(C[a]||(C[a]=y(a,"http://www.w3.org/2000/svg"))).cloneNode(!1);else if(a&&a.nodeType)b=a.cloneNode(!1);else throw Error("At least one argument required");H(b,c);return b};x.extend=function(a){a=C[a]||(C[a]=y(a,"http://www.w3.org/2000/svg"));return x.bind(this,a)};x.ns="http://www.w3.org/2000/svg";e.el=p;e.h=p;e.html=p;e.list=O;e.List=u;e.listPool=function(a,c,b){return new B(a,c,b)};e.ListPool=B;e.mount=
k;e.unmount=l;e.place=function(a,c){return new J(a,c)};e.Place=J;e.router=function(a,c,b){return new K(a,c,b)};e.Router=K;e.setAttr=F;e.setStyle=D;e.setChildren=I;e.s=x;e.svg=x;e.text=G;Object.defineProperty(e,"__esModule",{value:!0})});
